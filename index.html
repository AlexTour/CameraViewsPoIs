<!doctype html>
<html lang="en">
  <head>
    <title>&lt;model-viewer&gt; template</title>
    <meta charset="utf-8">
    <meta name="description" content="&lt;model-viewer&gt; template">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link type="text/css" href="./styles.css" rel="stylesheet"/>
    <!-- OPTIONAL: The :focus-visible polyfill removes the focus ring for some input types -->
    <script src="https://unpkg.com/focus-visible@5.0.2/dist/focus-visible.js" defer></script>
  </head>
  <body>
    <!-- <model-viewer> HTML element -->
    <model-viewer id="hotspot-camera-view" src="room-v1.glb" camera-controls touch-action="none" disable-tap interaction-prompt="none" field-of-view="45deg" min-field-of-view="25deg" max-field-of-view="45deg" interpolation-decay="200" max-camera-orbit="auto 90deg auto" min-camera-orbit="auto auto 5%" poster="poster.webp" shadow-intensity="0.83" environment-image="decor_shop_2k.hdr" camera-orbit="45deg 60deg auto" exposure="1.5">
      <button class="Hotspot" slot="hotspot-1" data-position="-39.053796445658406m 54.795968280719606m -220.43755251377686m" data-normal="0m 1.6292067939183141e-7m 0.9999999999999868m" data-orbit="-0.9488deg 87.92deg auto" data-target="31.08m -3.837m -926.8m" data-visibility-attribute="visible">
        <b>1</b>
      </button> 
      <button id="ShowMoreButton" onclick="toggle(this)">Show more</button>
        <div id="SectionName" style="display:none">
          <audio class="AudioAnnotation" id="AudioAnnotation" controls controlsList="nodownload">
            <source src="hey.mp3" type="audio/mpeg">
            Your browser does not support the audio element.
          </audio>          
        </div>                                                              
      <button class="Hotspot" slot="hotspot-2" data-position="268.54899010719697m -152.20854355626895m 199.52247372983248m" data-normal="0m 0.9999999999999869m -1.6292067872569765e-7m" data-orbit="45deg 60deg auto" data-target="50m 0m 0m" data-visibility-attribute="visible">
        <b>2</b>
      </button> 
      <div class="progress-bar hide" slot="progress-bar">
          <div class="update-bar"></div>
      </div>
      <button slot="ar-button" id="ar-button">
          View in your space
      </button>
      <div id="ar-prompt">
          <img src="ar_hand_prompt.png">
      </div>
    </model-viewer>  
    <button class="HotspotAnnotation" onclick="resetCameraPercent()">
      Reset Camera
    </button>
    <label class="switch">
      <input type="checkbox" id="myCheck" onclick="enableSkybox()">
      <span class="slider round"></span>
    </label>
    <label for="show-dimensions">Show Dimensions:</label>
    <input id="show-dimensions" type="checkbox" checked="true">
    <script type="module">
      const modelViewer2 = document.querySelector("#hotspot-camera-view");
      const annotationClicked = (annotation) => {
        let dataset = annotation.dataset;
        modelViewer2.cameraTarget = dataset.target;
        modelViewer2.cameraOrbit = dataset.orbit;
        modelViewer2.fieldOfView = '45deg';
      }
    
      modelViewer2.querySelectorAll('button').forEach((hotspot) => {
        hotspot.addEventListener('click', () => annotationClicked(hotspot));
      });
    </script>
    
    <script>
      const mv = document.querySelector("#hotspot-camera-view");
      function resetCameraPercent() {
        mv.cameraOrbit = '45deg 60deg auto%'
        mv.cameraTarget= '50m 0m 0m'
        mv.fieldOfView = '45deg'
      }
    </script>
    <script>
      let toggle = button => {
        var x = document.getElementById('SectionName');
        if (x.style.display == 'none') {
          x.style.display = 'block';
          button.innerText = "Show less";                                                    
        } else {
          x.style.display = 'none';
          button.innerText = "Show more";
        }
      }
    </script>
    <script>
       const modelViewer4 = document.querySelector("#hotspot-camera-view");
       const checkbox = modelViewer4.querySelector('#show-dimensions');

      function setVisibility(element) {
        if (checkbox.checked) {
          element.classList.remove('hide');
        } else {
           element.classList.add('hide');
        }
      }

      checkbox.addEventListener('change', () => {
        modelViewer4.querySelectorAll('button').forEach((hotspot) => {
        setVisibility(hotspot);
        });
      });
    </script>
    <script>
      function enableSkybox() {
        // Get the checkbox
        var checkBox = document.getElementById("myCheck");
        const modelViewer3 = document.querySelector("#hotspot-camera-view");

        // If the checkbox is checked, display the output text
        if (checkBox.checked == true){
          modelViewer3.setAttribute("skybox-image", "decor_shop_2k.hdr");
        } 
        else {
          modelViewer3.removeAttribute("skybox-image");
        }
      }
    </script>
    <script src="script.js"></script>
    <!-- Loads <model-viewer> for browsers: -->
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  </body>
</html>
